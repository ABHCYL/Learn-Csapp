## 第六章
### 6.1 存储技术
各种RAM(SRAM+DRAM+传统DRAM)。ROM。总线。磁盘。固态硬盘。
### 6.2 局部性
分为时间局部性和空间局部性。
>重复引用相同变量的程序有良好的时间局部性。
对于具有步长为k的引用模式的程序，步长越小，空间局部性越好。
对于取指令来说，循环有好的时间和空间局部性。循环体越小，循环迭代次数越多，局部性越好。
### 6.3 存储器的层次结构
![](https://github.com/ABHCYL/Learn-Csapp/blob/main/%E7%AC%AC6%E7%AB%A0/6.1.png)
### 6.4 cache
3种映射
>直接映射，全相联映射，组相联映射。

替换策略
![参考链接](https://www.jianshu.com/p/1f8e36285539)
>LFU 把频次最低的淘汰。LRU 把访问时间最久远的淘汰。
LRU，最近最少使用，把数据加入一个链表中，按访问时间排序，发生淘汰的时候，把访问时间最旧的淘汰掉。
LFU，最近不经常使用，把数据加入到链表中，按频次排序，一个数据被访问过，把它的频次+1，发生淘汰的时候，把频次低的淘汰掉。
显然
LRU对于循环出现的数据，缓存命中不高
比如，这样的数据，1，1，1，2，2，2，3，4，1，1，1，2，2，2.....
当走到3，4的时候，1，2会被淘汰掉，但是后面还有很多1，2
LFU对于交替出现的数据，缓存命中不高
比如，1，1，1，2，2，3，4，3，4，3，4，3，4，3，4，3，4......
由于前面被（1(3次)，2(2次)）
3加入把2淘汰，4加入把3淘汰，3加入把4淘汰，然而3，4才是最需要缓存的，1去到了3次，谁也淘汰不了它了。

关于cache写的问题
>写策略较复杂。书中简略介绍有直写和写回2种。
发生cache写命中时，直写保证了主存的数据是有效的，只要写入cache就要写入主存。缺点是每次写入都会引起总线流量降低了cache的功效；写回策略则是在cache写命中时只写入cache，只有cache的这一行要被替换时出去时才写入主存（在cache和主存之间异步写入），显然其优点是保证了cache的功效降低了总线流量但缺点是控制复杂。
### 6.5 and 6.6 编写cache友好的代码
6.5和6.6就是要提高cache命中率，在第5章中第5.12就介绍过了。不再重复。
